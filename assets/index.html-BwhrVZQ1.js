import{_ as n,c as a,e as p,o as t}from"./app-D9fezM6y.js";const e={};function o(c,s){return t(),a("div",null,s[0]||(s[0]=[p(`<h2 id="使用-umi-搭建一体机项目" tabindex="-1"><a class="header-anchor" href="#使用-umi-搭建一体机项目"><span>使用 umi 搭建一体机项目</span></a></h2><p>设计稿 1080 x 1920，不确定实际屏幕的宽高比</p><h3 id="ui-组件库" tabindex="-1"><a class="header-anchor" href="#ui-组件库"><span>UI 组件库</span></a></h3><p>考虑到一体机触摸体验，选用 Ant Design Mobile 高清适配，项目从 antd-mobile/2x 导入组件</p><ol><li>为了导入方便，做以下配置：</li></ol><div class="language-typescript line-numbers-mode" data-highlighter="prismjs" data-ext="ts"><pre><code class="language-typescript"><span class="line"><span class="token comment">// config.ts 中，配置一个从 antd-mobile 到 antd-mobile/2x 的别名</span></span>
<span class="line">alias<span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token string-property property">&quot;antd-mobile&quot;</span><span class="token operator">:</span> <span class="token keyword">require</span><span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">&quot;antd-mobile/2x&quot;</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"></div></div><ol start="2"><li>设置主题色</li></ol><div class="language-scss line-numbers-mode" data-highlighter="prismjs" data-ext="scss"><pre><code class="language-scss"><span class="line"><span class="token comment">// 正好 umi 中 a 标签的 color: var(--adm-color-primary)</span></span>
<span class="line"><span class="token selector">:root:root </span><span class="token punctuation">{</span></span>
<span class="line">  <span class="token property">--adm-color-primary</span><span class="token punctuation">:</span> <span class="token variable">#{$primary-color}</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"></div></div><div class="language-typescript line-numbers-mode" data-highlighter="prismjs" data-ext="ts"><pre><code class="language-typescript"><span class="line"><span class="token keyword">export</span> <span class="token keyword">const</span> primaryColor <span class="token operator">=</span> <span class="token string">&quot;#44bb55&quot;</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"></div></div><h3 id="目录结构" tabindex="-1"><a class="header-anchor" href="#目录结构"><span>目录结构</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line">📁owners-meeting</span>
<span class="line">├─ 📁config</span>
<span class="line">│  ├─ 📄config.ts <span class="token comment"># umi 配置文件</span></span>
<span class="line">│  └─ 📄routes.ts <span class="token comment"># 从配置文件中提取出来的路由配置</span></span>
<span class="line">├─ 📁public <span class="token comment"># 可能扔进服务器的静态资源</span></span>
<span class="line">└─ 📁src</span>
<span class="line">   ├─ 📁constants</span>
<span class="line">   │  └─ 📄color.ts <span class="token comment"># 如主题色等常量</span></span>
<span class="line">   ├─ 📁pages <span class="token comment"># 如果是一个单独的页面组件则采用大驼峰命名文件夹，否则采用小驼峰命名文件夹</span></span>
<span class="line">   ├─ 📁styles <span class="token comment"># 里面所有的mixin、变量、函数都是全局的（index.scss 是被 sass-resources-loader 处理过的）</span></span>
<span class="line">   ├─ 📁utils</span>
<span class="line">   │  ├─ 📄format.ts <span class="token comment"># 用于格式化的一些函数</span></span>
<span class="line">   │  └─ 📄px2.ts <span class="token comment"># 用于将 px 转换为 vw/vh 的函数</span></span>
<span class="line">   ├─ 📁layouts</span>
<span class="line">   └─ 📄global.scss <span class="token comment"># 全局样式文件</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"></div></div><h3 id="sass-resources-loader" tabindex="-1"><a class="header-anchor" href="#sass-resources-loader"><span>sass-resources-loader</span></a></h3><p>该 loader 处理过的 mixin、变量、函数等可以在任意 .scss 文件中不经导入使用</p><p>config.ts 中配置：</p><div class="language-typescript line-numbers-mode" data-highlighter="prismjs" data-ext="ts"><pre><code class="language-typescript"><span class="line"><span class="token function">chainWebpack</span><span class="token punctuation">(</span>config<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  config<span class="token punctuation">.</span>module</span>
<span class="line">    <span class="token punctuation">.</span><span class="token function">rule</span><span class="token punctuation">(</span><span class="token string">&quot;scss&quot;</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\\.scss$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token string">&quot;sass-loader&quot;</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">.</span><span class="token function">loader</span><span class="token punctuation">(</span><span class="token string">&quot;sass-loader&quot;</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token string">&quot;sass-resources-loader&quot;</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">.</span><span class="token function">loader</span><span class="token punctuation">(</span><span class="token string">&quot;sass-resources-loader&quot;</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">.</span><span class="token function">options</span><span class="token punctuation">(</span><span class="token punctuation">{</span></span>
<span class="line">      resources<span class="token operator">:</span> <span class="token punctuation">[</span>path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&quot;../src/styles/index.scss&quot;</span><span class="token punctuation">)</span><span class="token punctuation">]</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"></div></div><blockquote><p>注意：install sass-loader &amp; sass-resources-loader</p></blockquote><h3 id="尺寸适配" tabindex="-1"><a class="header-anchor" href="#尺寸适配"><span>尺寸适配</span></a></h3><p>基于 1080 x 1920 的设计稿，使用 <code>vw</code> 和 <code>vh</code> 单位进行适配。</p><div class="language-scss line-numbers-mode" data-highlighter="prismjs" data-ext="scss"><pre><code class="language-scss"><span class="line"><span class="token keyword">@use</span> <span class="token string">&quot;sass:math&quot;</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// 默认设计稿的宽度</span></span>
<span class="line"><span class="token property"><span class="token variable">$designWidth</span></span><span class="token punctuation">:</span> 1080<span class="token punctuation">;</span></span>
<span class="line"><span class="token comment">// 默认设计稿的高度</span></span>
<span class="line"><span class="token property"><span class="token variable">$designHeight</span></span><span class="token punctuation">:</span> 1920<span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// px 转为 vw 的函数</span></span>
<span class="line"><span class="token keyword">@function</span> <span class="token function">vw</span><span class="token punctuation">(</span><span class="token variable">$px</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">@return</span> math.<span class="token function">div</span><span class="token punctuation">(</span><span class="token variable">$px</span><span class="token punctuation">,</span> <span class="token variable">$designWidth</span><span class="token punctuation">)</span> <span class="token operator">*</span> 100vw<span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// px 转为 vh 的函数</span></span>
<span class="line"><span class="token keyword">@function</span> <span class="token function">vh</span><span class="token punctuation">(</span><span class="token variable">$px</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">@return</span> math.<span class="token function">div</span><span class="token punctuation">(</span><span class="token variable">$px</span><span class="token punctuation">,</span> <span class="token variable">$designHeight</span><span class="token punctuation">)</span> <span class="token operator">*</span> 100vh<span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"></div></div><div class="language-scss line-numbers-mode" data-highlighter="prismjs" data-ext="scss"><pre><code class="language-scss"><span class="line"><span class="token selector">.a </span><span class="token punctuation">{</span></span>
<span class="line">  <span class="token property">width</span><span class="token punctuation">:</span> <span class="token function">vw</span><span class="token punctuation">(</span>100<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token property">height</span><span class="token punctuation">:</span> <span class="token function">vh</span><span class="token punctuation">(</span>100<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"></div></div><div class="language-typescript line-numbers-mode" data-highlighter="prismjs" data-ext="ts"><pre><code class="language-typescript"><span class="line"><span class="token comment">// 定义设计稿的宽高</span></span>
<span class="line"><span class="token keyword">const</span> designWidth <span class="token operator">=</span> <span class="token number">1080</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">const</span> designHeight <span class="token operator">=</span> <span class="token number">1920</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">px2vw</span> <span class="token operator">=</span> <span class="token punctuation">(</span>_px<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">return</span> <span class="token punctuation">(</span>_px <span class="token operator">*</span> <span class="token number">100.0</span><span class="token punctuation">)</span> <span class="token operator">/</span> designWidth <span class="token operator">+</span> <span class="token string">&quot;vw&quot;</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">px2vh</span> <span class="token operator">=</span> <span class="token punctuation">(</span>_px<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">return</span> <span class="token punctuation">(</span>_px <span class="token operator">*</span> <span class="token number">100.0</span><span class="token punctuation">)</span> <span class="token operator">/</span> designHeight <span class="token operator">+</span> <span class="token string">&quot;vh&quot;</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"></div></div><div class="language-typescript line-numbers-mode" data-highlighter="prismjs" data-ext="ts"><pre><code class="language-typescript"><span class="line"><span class="token keyword">import</span> <span class="token punctuation">{</span> px2vw<span class="token punctuation">,</span> px2vh <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@/utils/px2.ts&quot;</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"></div></div><div class="language-scss line-numbers-mode" data-highlighter="prismjs" data-ext="scss"><pre><code class="language-scss"><span class="line"><span class="token comment">/**</span>
<span class="line">* 设置字体在特定屏幕中整体缩放</span>
<span class="line">*/</span></span>
<span class="line"><span class="token selector">html </span><span class="token punctuation">{</span></span>
<span class="line">  <span class="token property">font-size</span><span class="token punctuation">:</span> 100px <span class="token important">!important</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token atrule"><span class="token rule">@media</span> <span class="token punctuation">(</span><span class="token property">max-width</span><span class="token punctuation">:</span> 800px<span class="token punctuation">)</span></span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token selector">html </span><span class="token punctuation">{</span></span>
<span class="line">    <span class="token property">font-size</span><span class="token punctuation">:</span> 80px <span class="token important">!important</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"></div></div><ul><li>字体使用 rem 单位，方便整体缩放或者根据屏幕大小进行缩放 <ul><li><code>1rem = 100px</code>，即 20px 字体大小为 <code>0.2rem</code>。</li></ul></li></ul><h3 id="静态资源" tabindex="-1"><a class="header-anchor" href="#静态资源"><span>静态资源</span></a></h3><ul><li>图片：<code>/public/imgs/</code><ul><li>scss 文件中 <code>url(/imgs/xxx.png)</code>，ts 文件中部分使用 <code>import xxx from &quot;/public/imgs/xxx.png&quot;</code>（否则就尝试删掉 /public）</li></ul></li></ul><h3 id="手写的工具" tabindex="-1"><a class="header-anchor" href="#手写的工具"><span>手写的工具</span></a></h3><h4 id="页面跳转" tabindex="-1"><a class="header-anchor" href="#页面跳转"><span>页面跳转</span></a></h4><ul><li>项目中有一个可以获取路径的函数，getPath <ul><li>页面路径跟组件名称有对应关系，思路是 <code>getPath(所有页面组件 =&gt; 所有页面组件.跳转的页面组件名称, {参数1, 参数2, ...})</code> 即可拿到要跳转的路径</li></ul></li><li>umi 提供的跳转的 hook，<a href="https://umijs.org/docs/api/api#usenavigate" target="_blank" rel="noopener noreferrer">useNavigate</a></li></ul><div class="language-typescript line-numbers-mode" data-highlighter="prismjs" data-ext="ts"><pre><code class="language-typescript"><span class="line"><span class="token keyword">import</span> <span class="token punctuation">{</span> getPath <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@/utils/get&quot;</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">import</span> <span class="token punctuation">{</span> useNavigate <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;umi&quot;</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">const</span> navigate <span class="token operator">=</span> <span class="token function">useNavigate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">const</span> <span class="token function-variable function">handleClick</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token function">navigate</span><span class="token punctuation">(</span></span>
<span class="line">    <span class="token function">getPath</span><span class="token punctuation">(</span><span class="token punctuation">(</span>component<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> component<span class="token punctuation">.</span>Step1_2<span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token punctuation">{</span> param<span class="token operator">:</span> <span class="token string">&quot;a&quot;</span><span class="token punctuation">,</span> query1<span class="token operator">:</span> <span class="token string">&quot;b&quot;</span><span class="token punctuation">,</span> query2<span class="token operator">:</span> <span class="token string">&quot;c&quot;</span> <span class="token punctuation">}</span></span>
<span class="line">  <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// /xxx/step1-2/a?query1=b&amp;query2=c</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"></div></div><h4 id="无用数据过滤" tabindex="-1"><a class="header-anchor" href="#无用数据过滤"><span>无用数据过滤</span></a></h4><div class="language-typescript line-numbers-mode" data-highlighter="prismjs" data-ext="ts"><pre><code class="language-typescript"><span class="line"><span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">formatData</span> <span class="token operator">=</span> <span class="token punctuation">(</span></span>
<span class="line">  data<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">,</span></span>
<span class="line">  format<span class="token operator">?</span><span class="token operator">:</span> <span class="token punctuation">(</span>v<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token builtin">any</span><span class="token punctuation">,</span></span>
<span class="line">  options<span class="token operator">?</span><span class="token operator">:</span> <span class="token punctuation">{</span> sign<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">number</span> <span class="token operator">|</span> <span class="token builtin">string</span> <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">const</span> <span class="token punctuation">{</span> sign <span class="token punctuation">}</span> <span class="token operator">=</span> options <span class="token operator">||</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token keyword">const</span> uselessData <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token keyword">undefined</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token keyword">const</span> isEmptyArr <span class="token operator">=</span> <span class="token builtin">Array</span><span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> data<span class="token punctuation">.</span>length <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token keyword">const</span> isEmptyObj <span class="token operator">=</span> <span class="token keyword">typeof</span> data <span class="token operator">===</span> <span class="token string">&quot;object&quot;</span> <span class="token operator">&amp;&amp;</span> Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">.</span>length <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token keyword">if</span> <span class="token punctuation">(</span>uselessData<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token operator">||</span> isEmptyArr <span class="token operator">||</span> isEmptyObj<span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">return</span> sign <span class="token operator">||</span> <span class="token string">&quot;-&quot;</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token keyword">return</span> <span class="token keyword">typeof</span> format <span class="token operator">===</span> <span class="token string">&quot;function&quot;</span> <span class="token operator">?</span> <span class="token function">format</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token operator">:</span> data<span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"></div></div>`,32)]))}const i=n(e,[["render",o]]),u=JSON.parse('{"path":"/general/frontend/umi/","title":"","lang":"zh-CN","frontmatter":{},"git":{"updatedTime":1748428667000,"contributors":[{"name":"zhouling","username":"zhouling","email":"1309515883@qq.com","commits":3,"url":"https://github.com/zhouling"},{"name":"carla","username":"carla","email":"1309515883@qq.com","commits":1,"url":"https://github.com/carla"}],"changelog":[{"hash":"ae15eecadccf3c79390038ae2dbb5a221950c243","time":1748428667000,"email":"1309515883@qq.com","author":"carla","message":"调整目录"},{"hash":"e66bf4ca891f82797e2964cd1feaa361e80f1db8","time":1697030106000,"email":"1309515883@qq.com","author":"zhouling","message":"描述getPath的携带参数"},{"hash":"d9fdb3df52d6a02440d0bb5b2b3fa110a37200e8","time":1697029502000,"email":"1309515883@qq.com","author":"zhouling","message":"给getPath加上描述"},{"hash":"b002f26307c6a780f019e0d4849b0d81807bd2cd","time":1697029350000,"email":"1309515883@qq.com","author":"zhouling","message":"用umi搭建一体机项目总结"}]},"filePathRelative":"general/frontend/umi/index.md"}');export{i as comp,u as data};
